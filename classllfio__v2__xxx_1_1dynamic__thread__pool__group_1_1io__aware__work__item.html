<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLFIO: llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLFIO<span id="projectnumber">&#160;v2.00</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>A work item which paces when it next executes according to i/o congestion.  
 <a href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#details">More...</a></p>

<p><code>#include &quot;dynamic_thread_pool_group.hpp&quot;</code></p>
<div class="dynheader">
Inheritance diagram for llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.png" usemap="#llfio_5Fv2_5Fxxx::dynamic_5Fthread_5Fpool_5Fgroup::io_5Faware_5Fwork_5Fitem_map" alt=""/>
  <map id="llfio_5Fv2_5Fxxx::dynamic_5Fthread_5Fpool_5Fgroup::io_5Faware_5Fwork_5Fitem_map" name="llfio_5Fv2_5Fxxx::dynamic_5Fthread_5Fpool_5Fgroup::io_5Faware_5Fwork_5Fitem_map">
<area href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html" title="An individual item of work within the work group." alt="llfio_v2_xxx::dynamic_thread_pool_group::work_item" shape="rect" coords="0,0,366,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html">byte_io_handle_awareness</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about an i/o handle this work item will use.  <a href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a67bea92b65a3c5f3f9ece3aaf245775f" id="r_a67bea92b65a3c5f3f9ece3aaf245775f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#a67bea92b65a3c5f3f9ece3aaf245775f">io_aware_work_item</a> (span&lt; <a class="el" href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html">byte_io_handle_awareness</a> &gt; hs)</td></tr>
<tr class="memdesc:a67bea92b65a3c5f3f9ece3aaf245775f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a work item aware of i/o done to the handles in <code>hs</code>.  <br /></td></tr>
<tr class="separator:a67bea92b65a3c5f3f9ece3aaf245775f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa090c92e4adf339d8092465934b82f03" id="r_aa090c92e4adf339d8092465934b82f03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#aa090c92e4adf339d8092465934b82f03">io_aware_work_item</a> (<a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html">io_aware_work_item</a> &amp;&amp;o) noexcept</td></tr>
<tr class="separator:aa090c92e4adf339d8092465934b82f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c2da3502fd9d518cec57d538d7a6ad" id="r_ab4c2da3502fd9d518cec57d538d7a6ad"><td class="memItemLeft" align="right" valign="top">span&lt; <a class="el" href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html">byte_io_handle_awareness</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#ab4c2da3502fd9d518cec57d538d7a6ad">handles</a> () const noexcept</td></tr>
<tr class="memdesc:ab4c2da3502fd9d518cec57d538d7a6ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">The handles originally registered during construction.  <br /></td></tr>
<tr class="separator:ab4c2da3502fd9d518cec57d538d7a6ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92cec481e76ed36075100c0bf9f8821" id="r_ab92cec481e76ed36075100c0bf9f8821"><td class="memItemLeft" align="right" valign="top"><a id="ab92cec481e76ed36075100c0bf9f8821" name="ab92cec481e76ed36075100c0bf9f8821"></a>
virtual intptr_t&#160;</td><td class="memItemRight" valign="bottom"><b>io_aware_next</b> (<a class="el" href="structllfio__v2__xxx_1_1deadline.html">deadline</a> &amp;d) noexcept=0</td></tr>
<tr class="memdesc:ab92cec481e76ed36075100c0bf9f8821"><td class="mdescLeft">&#160;</td><td class="mdescRight">As for <code>work_item::next()</code>, but deadline may be extended to reduce i/o congestion on the hardware devices to which the handles refer. <br /></td></tr>
<tr class="separator:ab92cec481e76ed36075100c0bf9f8821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f2c8284a8a4dd980519a4139991558" id="r_ac0f2c8284a8a4dd980519a4139991558"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group.html">dynamic_thread_pool_group</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#ac0f2c8284a8a4dd980519a4139991558">parent</a> () const noexcept</td></tr>
<tr class="memdesc:ac0f2c8284a8a4dd980519a4139991558"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the parent work group between successful submission and just before <code>group_complete()</code>.  <br /></td></tr>
<tr class="separator:ac0f2c8284a8a4dd980519a4139991558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b99a46abe5da4e86f21e80dcf2bf699" id="r_a5b99a46abe5da4e86f21e80dcf2bf699"><td class="memItemLeft" align="right" valign="top">virtual result&lt; void &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#a5b99a46abe5da4e86f21e80dcf2bf699">operator()</a> (intptr_t work) noexcept=0</td></tr>
<tr class="separator:a5b99a46abe5da4e86f21e80dcf2bf699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d6ba54f52e216edd37474f19731fd8" id="r_ae8d6ba54f52e216edd37474f19731fd8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#ae8d6ba54f52e216edd37474f19731fd8">group_complete</a> (const result&lt; void &gt; &amp;cancelled) noexcept</td></tr>
<tr class="separator:ae8d6ba54f52e216edd37474f19731fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5860206701c43b7035475dc3f62a23ef" id="r_a5860206701c43b7035475dc3f62a23ef"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#a5860206701c43b7035475dc3f62a23ef">max_iosbusytime</a> {0.95f}</td></tr>
<tr class="memdesc:a5860206701c43b7035475dc3f62a23ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum i/o busyness above which throttling is to begin.  <br /></td></tr>
<tr class="separator:a5860206701c43b7035475dc3f62a23ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81540923522973756560e20c44a0e948" id="r_a81540923522973756560e20c44a0e948"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#a81540923522973756560e20c44a0e948">min_iosinprogress</a> {16}</td></tr>
<tr class="memdesc:a81540923522973756560e20c44a0e948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum i/o in progress to target if <code>iosbusytime</code> exceeded. The default of 16 suits SSDs, you want around 4 for spinning rust or NV-RAM.  <br /></td></tr>
<tr class="separator:a81540923522973756560e20c44a0e948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a240b9e4d3d0ee510c46347e735185688" id="r_a240b9e4d3d0ee510c46347e735185688"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html#a240b9e4d3d0ee510c46347e735185688">max_iosinprogress</a> {32}</td></tr>
<tr class="memdesc:a240b9e4d3d0ee510c46347e735185688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum i/o in progress to target if <code>iosbusytime</code> exceeded. The default of 32 suits SSDs, you want around 8 for spinning rust or NV-RAM.  <br /></td></tr>
<tr class="separator:a240b9e4d3d0ee510c46347e735185688"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa6641deb837cc77540b1a9bdf41afa6f" id="r_aa6641deb837cc77540b1a9bdf41afa6f"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#aa6641deb837cc77540b1a9bdf41afa6f">_has_timer_set_relative</a> () const noexcept</td></tr>
<tr class="separator:aa6641deb837cc77540b1a9bdf41afa6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c2850bf3778d32c335eace1f05ea3b7" id="r_a1c2850bf3778d32c335eace1f05ea3b7"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#a1c2850bf3778d32c335eace1f05ea3b7">_has_timer_set_absolute</a> () const noexcept</td></tr>
<tr class="separator:a1c2850bf3778d32c335eace1f05ea3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c49153ff193f7b3d948eec37b5509f7" id="r_a2c49153ff193f7b3d948eec37b5509f7"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1work__item.html#a2c49153ff193f7b3d948eec37b5509f7">_has_timer_set</a> () const noexcept</td></tr>
<tr class="separator:a2c49153ff193f7b3d948eec37b5509f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A work item which paces when it next executes according to i/o congestion. </p>
<p>Currently there is only a working implementation of this for the Microsoft Windows and Linux platforms, due to lack of working <code>statfs_t::f_iosinprogress</code> on other platforms. If retrieving that for a seekable handle does not work, the constructor throws an exception.</p>
<p>For seekable handles, currently <code>reads</code>, <code>writes</code> and <code>barriers</code> are ignored. We simply retrieve, periodically, <code>statfs_t::f_iosinprogress</code> and <code>statfs_t::f_iosbusytime</code> for the storage devices backing the seekable handle. If the recent averaged i/o wait time exceeds <code>max_iosbusytime</code> and the i/o in progress &gt; <code>max_iosinprogress</code>, <code>next()</code> will start setting the default deadline passed to <code>io_aware_next()</code>. Thereafter, every 1/10th of a second, if <code>statfs_t::f_iosinprogress</code> is above <code>max_iosinprogress</code>, it will increase the deadline by 1/16th, whereas if it is below <code>min_iosinprogress</code>, it will decrease the deadline by 1/16th. The default deadline chosen is always the worst of all the storage devices of all the handles. This will reduce concurrency within the kernel thread pool in order to reduce congestion on the storage devices. If at any point <code>statfs_t::f_iosbusytime</code> drops below <code>max_iosbusytime</code> as averaged across one second, and <code>statfs_t::f_iosinprogress</code> drops below <code>min_iosinprogress</code>, the additional throttling is completely removed. <code>io_aware_next()</code> can ignore the default deadline passed into it, and can set any other deadline.</p>
<p>For non-seekable handles, the handle must have an i/o multiplexer set upon it, and on Microsoft Windows, that i/o multiplexer must be utilising the IOCP instance of the global Win32 thread pool. For each <code>reads</code>, <code>writes</code> and <code>barriers</code> which is non-zero, a corresponding zero length i/o is constructed and initiated. When the i/o completes, and all readable handles in the work item's set have data waiting to be read, and all writable handles in the work item's set have space to allow writes, only then is the work item invoked with the next piece of work.</p>
<dl class="section note"><dt>Note</dt><dd>Non-seekable handle support is not implemented yet. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa2b895fcc057bd6ee33ba2c116e5e978" name="aa2b895fcc057bd6ee33ba2c116e5e978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2b895fcc057bd6ee33ba2c116e5e978">&#9670;&#160;</a></span>io_aware_work_item() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::io_aware_work_item </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  395</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a67bea92b65a3c5f3f9ece3aaf245775f" name="a67bea92b65a3c5f3f9ece3aaf245775f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67bea92b65a3c5f3f9ece3aaf245775f">&#9670;&#160;</a></span>io_aware_work_item() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::io_aware_work_item </td>
          <td>(</td>
          <td class="paramtype">span&lt; <a class="el" href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html">byte_io_handle_awareness</a> &gt;&#160;</td>
          <td class="paramname"><em>hs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a work item aware of i/o done to the handles in <code>hs</code>. </p>
<p>Note that the <code>reads</code>, <code>writes</code> and <code>barriers</code> are normalised to proportions out of <code>1.0</code> by this constructor, so if for example you had <code>reads/writes/barriers = 200/100/0</code>, after normalisation those become <code>0.66/0.33/0.0</code> such that the total is <code>1.0</code>. If <code>reads/writes/barriers = 0/0/0</code> on entry, they are replaced with <code>0.5/0.5/0.0</code>.</p>
<p>Note that normalisation is across <em>all</em> i/o handles in the set, so three handles each with <code>reads/writes/barriers = 200/100/0</code> on entry would have <code>0.22/0.11/0.0</code> each after construction. </p>

</div>
</div>
<a id="aa090c92e4adf339d8092465934b82f03" name="aa090c92e4adf339d8092465934b82f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa090c92e4adf339d8092465934b82f03">&#9670;&#160;</a></span>io_aware_work_item() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::io_aware_work_item </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html">io_aware_work_item</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  409</span>        : work_item(std::move(o))</div>
<div class="line"><span class="lineno">  410</span>        , _handles(o._handles)</div>
<div class="line"><span class="lineno">  411</span>    {</div>
<div class="line"><span class="lineno">  412</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2c49153ff193f7b3d948eec37b5509f7" name="a2c49153ff193f7b3d948eec37b5509f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c49153ff193f7b3d948eec37b5509f7">&#9670;&#160;</a></span>_has_timer_set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool llfio_v2_xxx::dynamic_thread_pool_group::work_item::_has_timer_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  214</span>{ <span class="keywordflow">return</span> _has_timer_set_relative() || _has_timer_set_absolute(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c2850bf3778d32c335eace1f05ea3b7" name="a1c2850bf3778d32c335eace1f05ea3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c2850bf3778d32c335eace1f05ea3b7">&#9670;&#160;</a></span>_has_timer_set_absolute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool llfio_v2_xxx::dynamic_thread_pool_group::work_item::_has_timer_set_absolute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  213</span>{ <span class="keywordflow">return</span> _timepoint2 != std::chrono::system_clock::time_point(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6641deb837cc77540b1a9bdf41afa6f" name="aa6641deb837cc77540b1a9bdf41afa6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6641deb837cc77540b1a9bdf41afa6f">&#9670;&#160;</a></span>_has_timer_set_relative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool llfio_v2_xxx::dynamic_thread_pool_group::work_item::_has_timer_set_relative </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  212</span>{ <span class="keywordflow">return</span> _timepoint1 != std::chrono::steady_clock::time_point(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8d6ba54f52e216edd37474f19731fd8" name="ae8d6ba54f52e216edd37474f19731fd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8d6ba54f52e216edd37474f19731fd8">&#9670;&#160;</a></span>group_complete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void llfio_v2_xxx::dynamic_thread_pool_group::work_item::group_complete </td>
          <td>(</td>
          <td class="paramtype">const result&lt; void &gt; &amp;&#160;</td>
          <td class="paramname"><em>cancelled</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Invoked by the i/o thread pool when all work in this thread pool group is complete.</p>
<p><code>cancelled</code> indicates if this is an abnormal completion. If its error compares equal to <code>errc::operation_cancelled</code>, then <code>stop()</code> was called.</p>
<p>Just before this is called for all work items submitted, the group becomes reset to fresh, and <code>parent()</code> becomes null. You can resubmit this work item, but do not submit other work items until their <code>group_complete()</code> has been invoked.</p>
<p>Note that this function is called from multiple kernel threads.</p>
<p><code>dynamic_thread_pool_group::current_work_item()</code> may have any value during this call. </p>
<div class="fragment"><div class="line"><span class="lineno">  324</span>{ (void) cancelled; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4c2da3502fd9d518cec57d538d7a6ad" name="ab4c2da3502fd9d518cec57d538d7a6ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4c2da3502fd9d518cec57d538d7a6ad">&#9670;&#160;</a></span>handles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">span&lt; <a class="el" href="structllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item_1_1byte__io__handle__awareness.html">byte_io_handle_awareness</a> &gt; llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::handles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The handles originally registered during construction. </p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>{ <span class="keywordflow">return</span> _handles; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b99a46abe5da4e86f21e80dcf2bf699" name="a5b99a46abe5da4e86f21e80dcf2bf699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b99a46abe5da4e86f21e80dcf2bf699">&#9670;&#160;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual result&lt; void &gt; llfio_v2_xxx::dynamic_thread_pool_group::work_item::operator() </td>
          <td>(</td>
          <td class="paramtype">intptr_t&#160;</td>
          <td class="paramname"><em>work</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Invoked by the i/o thread pool to perform the next item of work.</p>
<dl class="section return"><dt>Returns</dt><dd>Any failure causes all remaining work in this group to be cancelled as soon as possible. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">work</td><td>The value returned by <code>next()</code>.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that this function is called from multiple kernel threads, and may not be the kernel thread from which <code>next()</code> was called.</p>
<p><code>dynamic_thread_pool_group::current_work_item()</code> will always be <code>this</code> during this call. </p>

</div>
</div>
<a id="ac0f2c8284a8a4dd980519a4139991558" name="ac0f2c8284a8a4dd980519a4139991558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f2c8284a8a4dd980519a4139991558">&#9670;&#160;</a></span>parent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group.html">dynamic_thread_pool_group</a> * llfio_v2_xxx::dynamic_thread_pool_group::work_item::parent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the parent work group between successful submission and just before <code>group_complete()</code>. </p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>{ <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>dynamic_thread_pool_group *<span class="keyword">&gt;</span>(_parent.load(std::memory_order_relaxed)); }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5860206701c43b7035475dc3f62a23ef" name="a5860206701c43b7035475dc3f62a23ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5860206701c43b7035475dc3f62a23ef">&#9670;&#160;</a></span>max_iosbusytime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::max_iosbusytime {0.95f}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum i/o busyness above which throttling is to begin. </p>
<div class="fragment"><div class="line"><span class="lineno">  365</span>{0.95f};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a240b9e4d3d0ee510c46347e735185688" name="a240b9e4d3d0ee510c46347e735185688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a240b9e4d3d0ee510c46347e735185688">&#9670;&#160;</a></span>max_iosinprogress</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::max_iosinprogress {32}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum i/o in progress to target if <code>iosbusytime</code> exceeded. The default of 32 suits SSDs, you want around 8 for spinning rust or NV-RAM. </p>
<div class="fragment"><div class="line"><span class="lineno">  372</span>{32};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81540923522973756560e20c44a0e948" name="a81540923522973756560e20c44a0e948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81540923522973756560e20c44a0e948">&#9670;&#160;</a></span>min_iosinprogress</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t llfio_v2_xxx::dynamic_thread_pool_group::io_aware_work_item::min_iosinprogress {16}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum i/o in progress to target if <code>iosbusytime</code> exceeded. The default of 16 suits SSDs, you want around 4 for spinning rust or NV-RAM. </p>
<div class="fragment"><div class="line"><span class="lineno">  367</span>{16};</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/llfio/v2.0/<a class="el" href="dynamic__thread__pool__group_8hpp.html">dynamic_thread_pool_group.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacellfio__v2__xxx.html">llfio_v2_xxx</a></li><li class="navelem"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group.html">dynamic_thread_pool_group</a></li><li class="navelem"><a class="el" href="classllfio__v2__xxx_1_1dynamic__thread__pool__group_1_1io__aware__work__item.html">io_aware_work_item</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
